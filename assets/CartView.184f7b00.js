import{aa as x,u as B,a as N,k as C,aG as z,ac as S,o,c as i,b as a,w as n,V as $,e as h,f,d as t,F as D,aH as F,aI as I,af as c,Y as k,h as u,i as m,aJ as R,ag as T}from"./index.a0c66284.js";import{V as A}from"./VTable.9c5691d2.js";const E={id:"cart"},G=t("h1",{class:"text-center"},"\u8CFC\u7269\u8ECA",-1),H=t("thead",null,[t("tr",null,[t("th",null,"\u5716\u7247"),t("th",null,"\u540D\u7A31"),t("th",null,"\u55AE\u50F9"),t("th",null,"\u6578\u91CF"),t("th",null,"\u5C0F\u8A08"),t("th",null,"\u64CD\u4F5C")])],-1),J={key:0},L=t("td",{class:"text-center",colspan:"6"},"\u6C92\u6709\u5546\u54C1",-1),P=[L],K={__name:"CartView",setup(U){const y=x(),V=B(),{editCart:g,checkout:w}=V,l=N([]),d=async(e,r)=>{await g({_id:l[e].p_id._id,quantity:r}),l[e].quantity+=r,l[e].quantity<=0&&l.splice(e,1)},b=async()=>{await w(),y.push("/orders")},v=C(()=>l.reduce((e,r)=>e+r.p_id.price*r.quantity,0)),q=C(()=>l.length>0&&!l.some(e=>!e.p_id.sell));return(async()=>{try{const{data:e}=await z.get("/users/cart");l.push(...e.result)}catch{S.fire({icon:"error",title:"\u5931\u6557",text:"\u53D6\u5F97\u8CFC\u7269\u8ECA\u5931\u6557"})}})(),(e,r)=>(o(),i("div",E,[a($,null,{default:n(()=>[a(h,{cols:"12"},{default:n(()=>[G]),_:1}),a(f),a(h,{cols:"12"},{default:n(()=>[a(A,null,{default:n(()=>[H,t("tbody",null,[(o(!0),i(D,null,F(l,(s,_)=>(o(),i("tr",{key:s._id,class:R({"bg-red":!s.p_id.sell})},[t("td",null,[a(T,{"aspect-ratio":1,width:200,src:s.p_id.image},null,8,["src"])]),t("td",null,c(s.p_id.name),1),t("td",null,c(s.p_id.price),1),t("td",null,[a(u,{icon:"mdi-minus",size:"x-small",color:"primary",onClick:p=>d(_,-1)},null,8,["onClick"]),m("\xA0\xA0"+c(s.quantity)+"\xA0\xA0",1),a(u,{icon:"mdi-plus",size:"x-small",color:"primary",onClick:p=>d(_,1)},null,8,["onClick"])]),t("td",null,c(s.quantity*s.p_id.price),1),t("td",null,[a(u,{color:"red",onClick:p=>d(_,s.quantity*-1)},{default:n(()=>[m("\u522A\u9664")]),_:2},1032,["onClick"])])],2))),128)),l.length===0?(o(),i("tr",J,P)):I("",!0)])]),_:1})]),_:1}),a(f),a(h,{class:"text-center",cols:"12"},{default:n(()=>[t("p",null,"\u7E3D\u91D1\u984D "+c(k(v)),1),a(u,{color:"green",disabled:!k(q),onClick:b},{default:n(()=>[m("\u7D50\u5E33")]),_:1},8,["disabled"])]),_:1})]),_:1})]))}};export{K as default};
